<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Kitchen Ticket</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Cutive+Mono&display=swap');

    body {
      margin: 0;
      padding: 20px;
      background: transparent;
      color: #111;
      font-family: "Courier New", Courier, monospace;
      display: flex;
      justify-content: center;
    }

    .ticket {
      /* Customizable dimensions */
      /* Use min() to be responsive: fit viewport (minus padding) or cap at 768px */
      --ticket-width: min(100vw - 40px, 768px); 
      --design-width: 480;   /* The reference width the design is based on (unitless) */
      
      /* Scale factor logic */
      /* 16px is the standard browser base. We scale it relative to the width ratio. */
      /* Note: We multiply by 16 (unitless) because (Length / Number) = Length. */
      font-size: calc(var(--ticket-width) / var(--design-width) * 16);
      
      width: var(--ticket-width);
      
      box-sizing: border-box;
      padding: 1.25em; /* 20px */
    }

    .title, .footer {
      font-family: "Cutive Mono", monospace;
      text-align: center;
      font-size: 2em;
      letter-spacing: 0.05em;
      margin-bottom: 0.5em;
    }

    .footer {
      font-size: 2em;
      margin-top: 0.5em;
    }

    .rule {
      /* Adjust dash size here (in ems) */
      --dash-w: 0.5em; /* 8px */
      --gap-w: 0.25em; /* 4px */

      height: 0.1em; 
      margin: 0.75em 0;
      opacity: 0.75;
      width: 100%;
      
      background-image: linear-gradient(to right, currentColor var(--dash-w), transparent var(--dash-w));
      background-size: calc(var(--dash-w) + var(--gap-w)) 100%;
      background-repeat: repeat-x;
    }

    .label {
      font-size: 1.5em;
      margin: 0.52em 0;
    }

    .lineup {
      font-size: 1.75em;
      line-height: 1.4;
      margin-top: 0.3em;
      white-space: pre-line;
    }

    .logo-wrap {
      margin-top: 1em;
      display: flex;
      justify-content: center;
    }

    .logo {
      width: 6.25em; /* 100px */
      height: auto;
    }

    .center {
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="ticket">
    <div class="title" id="title"></div>
    <div class="rule"></div>

    <div class="label" id="date"></div>
    <div class="rule"></div>
    
    <div class="label" id="venue"></div>
    <div class="rule"></div>

    <div class="label">LINE UP:</div>
    <div class="lineup" id="lineup"></div>

    <div class="logo-wrap">
      <img class="logo" id="logo" src="./branding/logo.jpeg" alt="logo" />
    </div>

    <div class="footer" id="footerTitle"></div>
    <div class="rule"></div>

    <div class="label center" id="orderDue"></div>
  </div>

  <script>
    (async () => {
      try {
        const params = new URLSearchParams(window.location.search);
        const eventId = params.get('event') || '01';
        
        const res = await fetch(`./events/${eventId}.json`);
        if (!res.ok) throw new Error(`Event ${eventId} not found`);
        
        const data = await res.json();
        const set = (id, text) => {
          document.getElementById(id).textContent = text;
        };

        set('title', data.title);
        set('venue', `VENUE: ${data.venue}`);
        set('date', `DATE: ${data.date}`);
        set('lineup', data.lineup.join('\n'));
        set('footerTitle', data.footerTitle);
        set('orderDue', `- ORDER DUE: ${data.orderDue} -`);
        document.title = data.title;
      } catch (err) {
        document.body.innerHTML = `<div style="color:red; text-align:center;">${err.message}</div>`;
      }
    })();
  </script>
</body>
</html>
